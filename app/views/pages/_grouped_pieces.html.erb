<% grouped_pieces.each do |category, pieces| %>
  <div data-controller="pieces">
    <div data-pieces-target="category"
          data-action="click->pieces#toggleList"
          class='m-2 d-flex justify-content-between align-items-center'
          style='cursor:pointer;padding:10px;border-radius: 10px;background-color:white;'>
      <span class="w-100 text-overflow"
            style='font-size: 20px;'>
        <%= category.name %>
        <div class="piece-count"><%= pieces.count %> <%= "item".pluralize(pieces.count) %></div>
      </span>
      <img src='<%= category.photo_url %>'
            style='height: 100px;margin:-10px 0 -10px 0'>
    </div>

    <div data-pieces-target="list"
          class="d-none position-absolute"
          style="padding:0 20px 80px 20px;min-height:calc(100vh - 58px);top:0;right:0;left:0;">
      <div class="mt-3">
        <div class="button-back">
          <%= link_to generate_path do %>
          <h5><i class="fa-solid fa-arrow-right fa-rotate-180" data-action="click->pieces#toggleList"></i></h5>
          <% end %>
          <h2><%= category.name %> <span>(<%= pieces.count %>)</span> </h2>
        </div>
      </div>
        <div class="pieces-list mt-4">
          <% pieces.each do |piece| %>
            <%= render 'piece', piece: piece %>
          <% end %>
        </div>
    </div>
  </div>
<% end %>
